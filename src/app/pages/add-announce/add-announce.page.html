<ion-header id="ad-header">
  <ion-toolbar color="primary" class="custom-toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="home"></ion-back-button>
    </ion-buttons>
    <ion-title>
      <label>Adicionar Anuncio</label>
    </ion-title>
    <!-- <ion-buttons slot="end">
      <ion-button fill="clear" (click)="galeryMainPhoto()" color="warning" slot="end">
        <ion-icon size="large" slot="icon-only" name="md-save"></ion-icon>
      </ion-button>
    </ion-buttons> -->
  </ion-toolbar>
  <ion-toolbar color="primary">
    <ion-segment (ionChange)="segmentChanged($event)" [(ngModel)]="tab">
      <ion-segment-button [value]="AD_TAB">
        <ion-label> Anuncio</ion-label>
      </ion-segment-button>
      <ion-segment-button [value]="OPTIONS_TAB" layout="icon-start">
        <ion-icon size="small" color="warning" src="/assets/icon/lock-closed.svg" *ngIf="!activeOptions"></ion-icon>
        <ion-icon size="small" color="warning" src="/assets/icon/lock-open.svg" *ngIf="activeOptions"></ion-icon>
        <ion-label> Avanzadas</ion-label>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>
<ion-content fullscreen class="ion-padding">
  <div *ngIf="tab === AD_TAB" class="options-content">
    <ion-item>
      <ion-label position="floating">Título del anuncio</ion-label>
      <ion-input [(ngModel)]="ad.Titulo"></ion-input>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Precio</ion-label>
      <ion-input inputmode="numeric" type="number" [(ngModel)]="ad.Precio"></ion-input>
    </ion-item>
    <ion-item>
      <ion-label>Categoria</ion-label>
      <ionic-selectable #categorySelectAdd headerColor="primary" item-content itemTextField="Nombre"
        [items]="categories" [canSearch]="true" (onChange)="categoryChange($event)">
      </ionic-selectable>
    </ion-item>
    <ion-item *ngIf="tags && tags.length > 0">
      <ion-label>Etiquetas</ion-label>
      <ionic-selectable headerColor="primary" item-content [(ngModel)]="ad.Etiquetas" [isMultiple]="true"
        itemTextField="Nombre" [canClear]="true" [items]="tags" [canSearch]="true">
      </ionic-selectable>
    </ion-item>
    <ion-item>
      <ion-label>Acción</ion-label>
      <ionic-selectable headerColor="primary" item-content [(ngModel)]="ad.Accion" [items]="actionsAdd">
      </ionic-selectable>
    </ion-item>
    <ion-item>
      <ion-label>Municipio</ion-label>
      <ionic-selectable #municipioSelectAdd item-content itemValueField="Nombre" itemTextField="Nombre"
        groupValueField="provincia.Nombre" groupTextField="provincia.Nombre" [items]="localities"
        searchPlaceholder="Buscar" closeButtonText="Cerrar" closeButtonSlot="end" [canSearch]="true"
        headerColor="primary" (onChange)="municipioChange($event)">
        <ng-template ionicSelectableGroupTemplate let-group="group">
          {{group.text}}
        </ng-template>
      </ionic-selectable>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Descripción</ion-label>
      <ion-textarea [(ngModel)]="ad.Descripcion" rows="6" clearOnEdit="true"></ion-textarea>
    </ion-item>
    <ion-grid>
      <ion-row>
        <ion-col size="6">
          <ion-item lines="none">
            <ion-label>Nuevo</ion-label>
            <ion-checkbox class="custom-checkbox" slot="start" [(ngModel)]="ad.ProductoNuevo">
            </ion-checkbox>
          </ion-item>
        </ion-col>
        <ion-col size="6">
          <ion-item lines="none">
            <ion-label>Web</ion-label>
            <ion-checkbox class="custom-checkbox" slot="start" [(ngModel)]="ad.IsWeb"></ion-checkbox>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ion-item-divider mode="ios" color="primary">
      <ion-label>Datos del Contacto</ion-label>
    </ion-item-divider>
    <ion-item>
      <ion-label position="floating">Nombre</ion-label>
      <ion-input [(ngModel)]="ad.NombreContacto"></ion-input>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Teléfono</ion-label>
      <ion-input [(ngModel)]="ad.TelefonoContacto"></ion-input>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Correo</ion-label>
      <ion-input [(ngModel)]="ad.CorreoContacto"></ion-input>
    </ion-item>
    <ion-item-divider mode="ios" color="primary" class="images-form">
      <ion-label>Imagen Principal</ion-label>
      <ion-buttons slot="end">
        <ion-button fill="clear" (click)="mainPhoto(cameraOptions)" color="light">
          <ion-icon slot="icon-only" name="camera"></ion-icon>
        </ion-button>
        <ion-button fill="clear" (click)="mainPhoto(galeryOptions)" color="light">
          <ion-icon slot="icon-only" name="image"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item-divider>
    <ion-item class="images-custom" lines="full" *ngIf="mainImage">
      <ion-img [src]="mainImage"></ion-img>
      <!-- <ion-img src=""></ion-img> -->
      <ion-button fill="clear" (click)="removeMainPhoto()" color="primary" slot="end">
        <ion-icon size="large" slot="icon-only" name="md-close-circle"></ion-icon>
      </ion-button>
    </ion-item>
    <ion-item-divider mode="ios" color="primary" class="images-form">
      <ion-label>Imágenes Adicional</ion-label>
      <ion-buttons slot="end" *ngIf="ad.AlmacenImagen.length < configurations.Max_Img_Free">
        <ion-button fill="clear" (click)="freeAditionalPhoto(cameraOptions)" color="light">
          <ion-icon slot="icon-only" name="camera"></ion-icon>
        </ion-button>
        <ion-button fill="clear" (click)="freeAditionalPhoto(galeryOptions)" color="light">
          <ion-icon slot="icon-only" name="image"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item-divider>
    <div *ngIf="ad.AlmacenImagen.length > 0">
      <ion-item class="images-custom" lines="full" *ngFor="let image of ad.AlmacenImagen">
        <ion-img [src]="image.ImageContent"></ion-img>
        <ion-button fill="clear" (click)="removeFreeAditionalPhoto(image.ImageName)" color="primary" slot="end">
          <ion-icon size="large" slot="icon-only" name="md-close-circle"></ion-icon>
        </ion-button>
      </ion-item>
    </div>
  </div>
  <div class="options-content" *ngIf="tab === OPTIONS_TAB">
    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.destacado.IsActivo" slot="start"></ion-checkbox>
      <ion-label> Destacar el anuncio</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('destacado')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <ion-item *ngIf="payOptions.destacado.IsActivo">
      <ion-label position="fixed">Días a pagar:</ion-label>
      <ion-input inputmode="numeric" type="number" min="1" [(ngModel)]="payOptions.destacado.CantidadDias"></ion-input>
      <ion-label *ngIf="payOptions.destacado.Precio" slot="end" color="warning">Pts x Día: {{payOptions.destacado.Precio}}</ion-label>
    </ion-item>
    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.masEtiquetas.IsActivo" slot="start"></ion-checkbox>
      <ion-label>Comprar más etiquetas</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('masEtiquetas')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <div *ngIf="payOptions.masEtiquetas.IsActivo">
      <ion-item>
        <ion-label position="fixed">Días a pagar:</ion-label>
        <ion-input inputmode="numeric" type="number" min="1" [(ngModel)]="payOptions.masEtiquetas.CantidadDias"></ion-input>
        <ion-label *ngIf="payOptions.masEtiquetas.Precio" slot="end" color="warning">Pts x Día: {{payOptions.masEtiquetas.Precio}}</ion-label>
      </ion-item>
      <ion-item lines="full" class="ion-text-center custom">
        <div style="padding: 3px 0 0;">
          <ion-badge color="primary">Frituras <ion-icon name='close' class="tag-close"></ion-icon>
          </ion-badge>
          <ion-badge color="primary">Harina <ion-icon name='close' class="tag-close"></ion-icon>
          </ion-badge>
          <ion-badge color="primary">Clavo <ion-icon name='close' class="tag-close"></ion-icon>
          </ion-badge>
          <ion-badge color="primary">Frituras <ion-icon name='close' class="tag-close"></ion-icon>
          </ion-badge>
          <ion-badge color="primary">Pan Suave <ion-icon name='close' class="tag-close"></ion-icon>
          </ion-badge>
          <ion-badge color="primary">Herrero <ion-icon name='close' class="tag-close"></ion-icon>
          </ion-badge>
        </div>
        <ion-button fill="clear" (click)="addTag()" color="primary" slot="end">
          <ion-icon side="large" slot="icon-only" name="add" style="width: 28px;height: 28px;"></ion-icon>
        </ion-button>
      </ion-item>
    </div>
    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.autorenovar.IsActivo" slot="start"></ion-checkbox>
      <ion-label>Autorenovar periódicamente</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('autorenovar')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <div *ngIf="payOptions.autorenovar.IsActivo">
      <ion-item>
        <ion-label position="fixed">Días a pagar:</ion-label>
        <ion-input inputmode="numeric" type="number" min="1" [(ngModel)]="payOptions.autorenovar.CantidadDias"></ion-input>
        <ion-label *ngIf="payOptions.autorenovar.Precio" slot="end" color="warning">Pts x Día: {{payOptions.autorenovar.Precio}}</ion-label>
      </ion-item>
      <ion-item lines="full">
        <ion-label slot="start" style="max-width: 85px;">Frecuencia</ion-label>
        <ion-select value="AUTO_24" (ionChange)="changeAuto($event)" cancelText="Cancelar" okText="Aceptar" style="min-width: -webkit-fill-available;">
          <ion-select-option value="AUTO_24">Cada 24 horas</ion-select-option>
          <ion-select-option value="AUTO_6">Cada 6 horas</ion-select-option>
          <ion-select-option value="AUTO_1">Cada 1 hora</ion-select-option>
          <ion-select-option value="AUTO_TOP">Autorenovable Top</ion-select-option>
        </ion-select>
      </ion-item>
    </div>
    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.web.IsActivo" slot="start"></ion-checkbox>
      <ion-label>Anuncie su web</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('web')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <div *ngIf="payOptions.web.IsActivo">
      <ion-item>
        <ion-label position="fixed">Días a pagar:</ion-label>
        <ion-input inputmode="numeric" type="number" min="1" [(ngModel)]="payOptions.web.CantidadDias"></ion-input>
        <ion-label *ngIf="payOptions.web.Precio" slot="end" color="warning">Pts x Día: {{payOptions.web.Precio}}</ion-label>
      </ion-item>
      <ion-item lines="full">
        <ion-checkbox (ionChange)="changeMyWeb($event)" slot="start"></ion-checkbox>
        <ion-label>Mi web es el anuncio</ion-label>
      </ion-item>
      <ion-item lines="full">
        <ion-label position="fixed">URL:</ion-label>
        <ion-input [(ngModel)]="ad.NombreContacto"></ion-input>
      </ion-item>
    </div>
    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.masImages.IsActivo" slot="start"></ion-checkbox>
      <ion-label>Inserte más imágenes</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('masImages')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <div *ngIf="payOptions.masImages.IsActivo"></div>
    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.bannerInferior.IsActivo" slot="start"></ion-checkbox>
      <ion-label>Anuncie banner inferior</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('bannerInferior')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <div *ngIf="payOptions.bannerInferior.IsActivo"></div>

    <ion-item-divider mode="ios" color="primary">
      <ion-checkbox [(ngModel)]="payOptions.bannnerSuperior.IsActivo" slot="start"></ion-checkbox>
      <ion-label>Anuncie banner superior</ion-label>
      <ion-button fill="clear" (click)="presentAlertConfirm('bannerSuperior')" color="light" slot="end">
        <ion-icon slot="icon-only" name="information-circle"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <div *ngIf="payOptions.bannnerSuperior.IsActivo"></div>

  </div>

</ion-content>
<ion-footer>
  <ion-toolbar color="light">
    <ion-label *ngIf="calculate() !== 0" color="warning" slot="start" style="margin-left: 5px;">Pts a Pagar: <strong> {{calculate()}} </strong> </ion-label>
    <ion-buttons slot="end">
      <ion-button color="primary" [routerLink]="['/', 'home']">
        Cancelar
      </ion-button>
      <ion-button class="save-button" fill="solid" shape="round" color="primary" (click)="save()">
        Guardar
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>